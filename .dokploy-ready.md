# ✅ Proyecto listo para Dokploy

## Cambios realizados para Dokploy

### 1. **Dockerfile optimizado**
- ✅ Eliminado health check que puede causar problemas
- ✅ Build multi-stage con pnpm
- ✅ Imagen final basada en nginx:stable-alpine
- ✅ Puerto 80 expuesto

### 2. **Configuración de Astro**
- ✅ Output configurado como `static`
- ✅ Build optimizado con inline stylesheets automático

### 3. **Nginx configurado**
- ✅ Optimizado para servir sitios estáticos
- ✅ Fallback SPA para rutas
- ✅ Headers de seguridad
- ✅ Cache para assets estáticos
- ✅ Endpoint `/health` para health checks
- ✅ Soporte para reverse proxy

### 4. **dokploy.yaml**
- ✅ Configuración de build
- ✅ Puerto 80 especificado
- ✅ Health check configurado

## Cómo desplegar en Dokploy

### Opción 1: Desde GitHub/GitLab
1. Conecta tu repositorio en Dokploy
2. Selecciona "Docker" como tipo de aplicación
3. Dokploy detectará automáticamente el `dokploy.yaml`
4. Configura tu dominio en la configuración de Dokploy
5. Despliega

### Opción 2: Build manual
1. En Dokploy, crea una nueva aplicación
2. Selecciona "Docker" como tipo
3. Apunta al repositorio
4. Dokploy usará el `Dockerfile` automáticamente
5. Configura el puerto 80 en la configuración
6. Despliega

## Verificar build localmente (opcional)

```bash
# Build de la imagen
docker build -t portfolio-test .

# Ejecutar localmente
docker run -p 3000:80 portfolio-test

# Visitar http://localhost:3000
```

## Variables de entorno

Este proyecto no requiere variables de entorno para funcionar. Si en el futuro necesitas agregar alguna:
- En Dokploy: Ve a la sección "Environment" de tu aplicación
- Agrega las variables necesarias
- Redespliega

## Notas importantes

- El proyecto se sirve en el puerto **80** internamente
- Dokploy manejará el SSL/HTTPS automáticamente con su reverse proxy
- El health check está en `/health`
- Todos los assets estáticos tienen cache de 1 año
- El sitio es completamente estático (sin SSR)

## Troubleshooting

### Si el build falla:
1. Verifica que `pnpm-lock.yaml` esté actualizado
2. Asegúrate de que todas las dependencias estén en `package.json`
3. Revisa los logs de build en Dokploy

### Si la aplicación no carga:
1. Verifica que el puerto 80 esté configurado en Dokploy
2. Revisa los logs del contenedor
3. Verifica que el health check responda en `/health`

### Si hay problemas con assets:
1. Verifica que el build de Astro se completó correctamente
2. Asegúrate de que `dist/` tiene todos los archivos
3. Revisa la configuración de nginx
